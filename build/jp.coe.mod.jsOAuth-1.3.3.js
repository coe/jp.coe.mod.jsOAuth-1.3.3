/*

 jsOAuth version 1.3.3
 Copyright (c) 2010, 2011 Rob Griffiths (http://bytespider.eu)
 jsOAuth is freely distributable under the terms of an MIT-style license.
*/
var exports=exports||this;
exports.OAuth=function(j){function v(a){var b=arguments.callee,c;if(!(this instanceof b))return new b(a);for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);return this}function n(){}function x(a){var b=arguments.callee,c,d,e,f,o;d=/^([^:\/?#]+?:\/\/)*([^\/:?#]*)?(:[^\/?#]*)*([^?#]*)(\?[^#]*)?(#(.*))*/;if(!(this instanceof b))return new b(a);this.path=this.port=this.host=this.scheme="";this.query=new h;this.anchor="";if(null!==a){c=a.match(d);b=c[1];d=c[2];e=c[3];f=c[4];o=c[5];c=c[6];b=void 0!==b?b.replace("://",
"").toLowerCase():"http";e=e?e.replace(":",""):"https"===b?"443":"80";b="http"==b&&"443"===e?"https":b;o=o?o.replace("?",""):"";c=c?c.replace("#",""):"";if("https"===b&&"443"!==e||"http"===b&&"80"!==e)d=d+":"+e;this.scheme=b;this.host=d;this.port=e;this.path=f||"/";this.query.setQueryParams(o);this.anchor=c||""}}function h(a){var b=arguments.callee,c;if(!(this instanceof b))return new b(a);if(void 0!=a)for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);return this}function g(a){return!(this instanceof
g)?new g(a):this.init(a)}function w(a){var b=[],c,d;for(c in a)a[c]&&void 0!==a[c]&&""!==a[c]&&("realm"===c?d=c+'="'+a[c]+'"':b.push(c+'="'+g.urlEncode(a[c]+"")+'"'));b.sort();d&&b.unshift(d);return b.join(", ")}function B(a,b,c,d){var e=[],f,o=g.urlEncode;for(f in c)void 0!==c[f]&&""!==c[f]&&e.push([g.urlEncode(f),g.urlEncode(c[f]+"")]);for(f in d)void 0!==d[f]&&""!==d[f]&&(c[f]||e.push([o(f),o(d[f]+"")]));e=e.sort(function(a,b){return a[0]<b[0]?-1:a[0]>b[0]?1:a[1]<b[1]?-1:a[1]>b[1]?1:0}).map(function(a){return a.join("=")});
return[a,o(b),o(e.join("&"))].join("&")}function C(a){function b(){return Math.floor(Math.random()*f.length)}var c=(a||64)/8,a="",d=c/4,c=c%4,e,f="20,21,22,23,24,25,26,27,28,29,2A,2B,2C,2D,2E,2F,30,31,32,33,34,35,36,37,38,39,3A,3B,3C,3D,3E,3F,40,41,42,43,44,45,46,47,48,49,4A,4B,4C,4D,4E,4F,50,51,52,53,54,55,56,57,58,59,5A,5B,5C,5D,5E,5F,60,61,62,63,64,65,66,67,68,69,6A,6B,6C,6D,6E,6F,70,71,72,73,74,75,76,77,78,79,7A,7B,7C,7D,7E".split(",");for(e=0;e<d;e++)a+=f[b()]+f[b()]+f[b()]+f[b()];for(e=0;e<
c;e++)a+=f[b()];return a}function A(a){return Array(++a).join(0).split("")}function t(a){var b=[],c,d;for(d=0;d<a.length;d++)c=a.charCodeAt(d),128>c?b.push(c):2048>c?b.push(192+(c>>6),128+(c&63)):65536>c?b.push(224+(c>>12),128+(c>>6&63),128+(c&63)):2097152>c&&b.push(240+(c>>18),128+(c>>12&63),128+(c>>6&63),128+(c&63));return b}function p(a){if(void 0!==a){var b=a;b.constructor===String&&(b=t(b));var a=(this instanceof p?this:new p(a)).hash(b),b=[],c=a.length,d;for(d=0;d<c;d++)b.push((a[d]>>>4).toString(16)),
b.push((a[d]&15).toString(16));return b.join("")}return!(this instanceof p)?new p:this}n.prototype={join:function(a){return this.values().join(a||"")},keys:function(){var a,b=[];for(a in this)this.hasOwnProperty(a)&&b.push(a);return b},values:function(){var a,b=[];for(a in this)this.hasOwnProperty(a)&&b.push(this[a]);return b},shift:function(){throw"not implimented";},unshift:function(){throw"not implimented";},push:function(){throw"not implimented";},pop:function(){throw"not implimented";},sort:function(){throw"not implimented";
},ksort:function(a){var b=this.keys(),c,d;void 0==a?b.sort():b.sort(a);for(a=0;a<b.length;a++)d=b[a],c=this[d],delete this[d],this[d]=c;return this},toObject:function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&(a[b]=this[b]);return a}};v.prototype=new n;x.prototype={scheme:"",host:"",port:"",path:"",query:"",anchor:"",toString:function(){var a=this.query+"";return this.scheme+"://"+this.host+this.path+(""!=a?"?"+a:"")+(""!==this.anchor?"#"+this.anchor:"")}};h.prototype=new v;h.prototype.toString=
function(){var a,b=[],c="",d="",e=g.urlEncode;this.ksort();for(a in this)this.hasOwnProperty(a)&&void 0!=a&&void 0!=this[a]&&(d=e(a)+"="+e(this[a]),b.push(d));0<b.length&&(c=b.join("&"));return c};h.prototype.setQueryParams=function(a){var b=arguments,c,d,e;if(1==b.length)if("object"===typeof a)for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);else{if("string"===typeof a){b=a.split("&");for(c=0,d=b.length;c<d;c++)e=b[c].split("="),this[e[0]]=e[1]}}else for(c=0;c<arg_length;c+=2)this[b[c]]=b[c+1]};g.prototype=
{realm:"",requestTokenUrl:"",authorizationUrl:"",accessTokenUrl:"",init:function(a){var b=a.enablePrivilege||!1,c=a.callbackUrl||"oob",d=a.consumerKey,e=a.consumerSecret,f=a.accessTokenKey||"",o=a.accessTokenSecret||"",z="",l=a.signatureMethod||"HMAC-SHA1";this.realm=a.realm||"";this.requestTokenUrl=a.requestTokenUrl||"";this.authorizationUrl=a.authorizationUrl||"";this.accessTokenUrl=a.accessTokenUrl||"";this.getAccessToken=function(){return[f,o]};this.getAccessTokenKey=function(){return f};this.getAccessTokenSecret=
function(){return o};this.getAccessConsumerKey=function(){return d};this.getAccessConsumerSecret=function(){return e};this.setAccessToken=function(a,b){b&&(a=[a,b]);f=a[0];o=a[1]};this.getVerifier=function(){return z};this.setVerifier=function(a){z=a};this.setCallbackUrl=function(a){c=a};this.request=function(a){var h,k,m,q,n,p,i,r,u,s=[],v;u={};var t,y;h=a.method||"GET";k=x(a.url);m=a.data||{};q=a.headers||{};n=a.success||function(){};p=a.failure||function(){};y=function(){var a=!1,b;for(b in m)"undefined"!=
typeof m[b].fileName&&(a=!0);return a}();v=a.appendQueryString?a.appendQueryString:!1;b&&netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead UniversalBrowserWrite");i="undefined"!==typeof j.Titanium&&"undefined"!=typeof j.Titanium.Network.createHTTPClient?j.Titanium.Network.createHTTPClient():"undefined"!==typeof require?(new require("xhr")).XMLHttpRequest():new j.XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState){var a=/^(.*?):\s*(.*?)\r?$/mg,b={},c="",d;if(i.getAllResponseHeaders)for(c=
i.getAllResponseHeaders();d=a.exec(c);)b[d[1]]=d[2];else if(i.getResponseHeaders){c=i.getResponseHeaders();a=0;for(d=c.length;a<d;++a)b[c[a][0]]=c[a][1]}c=!1;"Content-Type"in b&&"text/xml"==b["Content-Type"]&&(c=!0);b={text:i.responseText,xml:c?i.responseXML:"",requestHeaders:q,responseHeaders:b};200<=i.status&&226>=i.status||304==i.status||0===i.status?n(b):400<=i.status&&0!==i.status&&p(b);"undefined"!==typeof j.Titanium&&(i.onerror=null,i.onload=null,i.onreadystatechange=null,i=i.ondatastream=
null)}};i.onerror=function(a){p(a);"undefined"!==typeof j.Titanium&&(i.onerror=null,i.onload=null,i.onreadystatechange=null,i=i.ondatastream=null)};a={oauth_callback:c,oauth_consumer_key:d,oauth_nonce:C(),oauth_signature_method:l,oauth_timestamp:parseInt(+new Date/1E3,10),oauth_token:f,oauth_verifier:z,oauth_version:"1.0"};if((!("Content-Type"in q)||"application/x-www-form-urlencoded"==q["Content-Type"])&&!y){t=k.query.toObject();for(r in t)u[r]=t[r];for(r in m)u[r]=m[r]}urlString=k.scheme+"://"+
k.host+k.path;u=B(h,urlString,a,u);u=g.signatureMethod[l](e,o,u);a.oauth_signature=u;this.realm&&(a.realm=this.realm);if(v||"GET"==h)k.query.setQueryParams(m),s=null;else if(y){if(y)for(r in s=new FormData,m)s.append(r,m[r])}else if("string"==typeof m)s=m,"Content-Type"in q||(q["Content-Type"]="text/plain");else if("undefined"!==typeof j.Titanium)s=m;else{for(r in m)s.push(g.urlEncode(r)+"="+g.urlEncode(m[r]+""));s=s.sort().join("&");"Content-Type"in q||(q["Content-Type"]="application/x-www-form-urlencoded")}i.open(h,
k+"",!0);"Content-Type"in q&&"undefined"!==typeof j.Titanium&&"android"===j.Titanium.Platform.osname&&delete q["Content-Type"];"Authorization"in q||i.setRequestHeader("Authorization","OAuth "+w(a));i.setRequestHeader("X-Requested-With","XMLHttpRequest");for(r in q)i.setRequestHeader(r,q[r]);i.send(s)};return this},get:function(a,b,c){this.request({url:a,success:b,failure:c})},post:function(a,b,c,d){this.request({method:"POST",url:a,data:b,success:c,failure:d})},getJSON:function(a,b,c){this.get(a,
function(a){b(JSON.parse(a.text))},c)},postJSON:function(a,b,c,d){this.request({method:"POST",url:a,data:JSON.stringify(b),success:function(a){c(JSON.parse(a.text))},failure:d,headers:{"Content-Type":"application/json"}})},parseTokenRequest:function(a,b){switch(b){case "text/xml":var c=a.xml.getElementsByTagName("token"),d=a.xml.getElementsByTagName("secret");f[g.urlDecode(c[0])]=g.urlDecode(d[0]);break;default:for(var c=0,d=a.text.split("&"),e=d.length,f={};c<e;++c){var o=d[c].split("=");f[g.urlDecode(o[0])]=
g.urlDecode(o[1])}}return f},fetchRequestToken:function(a,b){var c=this;c.setAccessToken("","");var d=c.authorizationUrl;this.get(this.requestTokenUrl,function(b){var f=c.parseTokenRequest(b,b.responseHeaders["Content-Type"]||void 0);c.setAccessToken([f.oauth_token,f.oauth_token_secret]);a(d+"?"+b.text)},b)},fetchAccessToken:function(a,b){var c=this;this.get(this.accessTokenUrl,function(b){var e=c.parseTokenRequest(b,b.responseHeaders["Content-Type"]||void 0);c.setAccessToken([e.oauth_token,e.oauth_token_secret]);
c.setVerifier("");a(b)},b)}};g.signatureMethod={"HMAC-SHA1":function(a,b,c){var d=g.urlEncode,a=d(a),b=d(b||""),d=p.prototype,a=t(a+"&"+b),c=t(c),b=a.length,e;b>d.blocksize&&(a=d.hash(a),b=a.length);a=a.concat(A(d.blocksize-b));b=a.slice(0);a=a.slice(0);for(e=0;e<d.blocksize;e++)b[e]^=92,a[e]^=54;d=d.hash(b.concat(d.hash(a.concat(c))));c="";a=d.length;for(b=0;b<a;b++)c+=String.fromCharCode(d[b]);return j.btoa(c)}};g.urlEncode=function(a){function b(a){a=a.toString(16).toUpperCase();2>a.length&&(a=
0+a);return"%"+a}if(!a)return"";for(var a=a+"",c=/[ \r\n!*"'();:@&=+$,\/?%#\[\]<>{}|`^\\\u0080-\uffff]/,d=a.length,e=a.split(""),f,a=0;a<d;a++)if(f=e[a].match(c))f=f[0].charCodeAt(0),128>f?e[a]=b(f):2048>f?e[a]=b(192+(f>>6))+b(128+(f&63)):65536>f?e[a]=b(224+(f>>12))+b(128+(f>>6&63))+b(128+(f&63)):2097152>f&&(e[a]=b(240+(f>>18))+b(128+(f>>12&63))+b(128+(f>>6&63))+b(128+(f&63)));return e.join("")};g.urlDecode=function(a){return!a?"":a.replace(/%[a-fA-F0-9]{2}/ig,function(a){return String.fromCharCode(parseInt(a.replace("%",
""),16))})};p.prototype=new p;p.prototype.blocksize=64;p.prototype.hash=function(a){var b=[1732584193,4023233417,2562383102,271733878,3285377520],c=[1518500249,1859775393,2400959708,3395469782],d,e,f,g,h,l,j,p,k,m;a.constructor===String&&(a=t(a.encodeUTF8()));d=a.length;f=Math.ceil((d+9)/this.blocksize)*this.blocksize-(d+9);e=Math.floor(d/4294967296);d=Math.floor(d%4294967296);e=[8*e>>24&255,8*e>>16&255,8*e>>8&255,8*e&255,8*d>>24&255,8*d>>16&255,8*d>>8&255,8*d&255];a=a.concat([128],A(f),e);f=Math.ceil(a.length/
this.blocksize);for(e=0;e<f;e++){g=a.slice(e*this.blocksize,(e+1)*this.blocksize);h=g.length;d=[];for(l=0;l<h;l++)d[l>>>2]|=g[l]<<24-8*(l-4*(l>>2));g=b[0];h=b[1];l=b[2];j=b[3];p=b[4];for(k=0;80>k;k++){16<=k&&(d[k]=(d[k-3]^d[k-8]^d[k-14]^d[k-16])<<1|(d[k-3]^d[k-8]^d[k-14]^d[k-16])>>>31);m=Math.floor(k/20);var q=g<<5|g>>>27,n;a:{switch(m){case 0:n=h&l|~h&j;break a;case 1:case 3:n=h^l^j;break a;case 2:n=h&l|h&j|l&j;break a}n=-1}m=q+n+p+c[m]+d[k];p=j;j=l;l=h<<30|h>>>2;h=g;g=m}b[0]+=g;b[1]+=h;b[2]+=l;
b[3]+=j;b[4]+=p}a=[];for(c=0;c<32*b.length;c+=8)a.push(b[c>>>5]>>>24-c%32&255);return a};return g}(this);
(function(j){j.btoa=j.btoa||function(j){for(var n=0,x=j.length,h,g,w="";n<x;n+=3)h=[j.charCodeAt(n),j.charCodeAt(n+1),j.charCodeAt(n+2)],g=[h[0]>>2,(h[0]&3)<<4|h[1]>>4,(h[1]&15)<<2|h[2]>>6,h[2]&63],isNaN(h[1])&&(g[2]=64),isNaN(h[2])&&(g[3]=64),w+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g[0])+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g[1])+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g[2])+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g[3]);
return w}})(this);